<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 Lesson 1 | HEADS 2nd semester</title>
  <meta name="description" content="HEADS’s homeworks compilation." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 Lesson 1 | HEADS 2nd semester" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="HEADS’s homeworks compilation." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 Lesson 1 | HEADS 2nd semester" />
  
  <meta name="twitter:description" content="HEADS’s homeworks compilation." />
  

<meta name="author" content="Bruno A Lima" />


<meta name="date" content="2020-03-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stats.html"/>
<link rel="next" href="lesson-2-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">HEADS 2nd semester 2019/2020</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="compstat.html"><a href="compstat.html"><i class="fa fa-check"></i><b>2</b> COMPSTAT</a><ul>
<li class="chapter" data-level="2.1" data-path="lesson-1.html"><a href="lesson-1.html"><i class="fa fa-check"></i><b>2.1</b> Lesson 1</a></li>
<li class="chapter" data-level="2.2" data-path="lesson-2.html"><a href="lesson-2.html"><i class="fa fa-check"></i><b>2.2</b> Lesson 2</a></li>
<li class="chapter" data-level="2.3" data-path="assignment-histogram.html"><a href="assignment-histogram.html"><i class="fa fa-check"></i><b>2.3</b> assignment Histogram</a></li>
<li class="chapter" data-level="2.4" data-path="assignment-matrix.html"><a href="assignment-matrix.html"><i class="fa fa-check"></i><b>2.4</b> assignment Matrix</a><ul>
<li class="chapter" data-level="2.4.1" data-path="assignment-matrix.html"><a href="assignment-matrix.html#keep-sample-matrix"><i class="fa fa-check"></i><b>2.4.1</b> keep sample matrix</a></li>
<li class="chapter" data-level="2.4.2" data-path="assignment-matrix.html"><a href="assignment-matrix.html#keep-sample-matrix-over-a-sliding-window"><i class="fa fa-check"></i><b>2.4.2</b> keep sample matrix over a sliding window</a></li>
<li class="chapter" data-level="2.4.3" data-path="assignment-matrix.html"><a href="assignment-matrix.html#keep-sample-matrix-over-a-alpha-weighted-sliding-window"><i class="fa fa-check"></i><b>2.4.3</b> keep sample matrix over a alpha weighted sliding window</a></li>
<li class="chapter" data-level="2.4.4" data-path="assignment-matrix.html"><a href="assignment-matrix.html#keep-sample-matrix-over-a-alpha-fading-window"><i class="fa fa-check"></i><b>2.4.4</b> keep sample matrix over a alpha fading window</a></li>
<li class="chapter" data-level="2.4.5" data-path="assignment-matrix.html"><a href="assignment-matrix.html#bonus"><i class="fa fa-check"></i><b>2.4.5</b> Bonus</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="lesson-3.html"><a href="lesson-3.html"><i class="fa fa-check"></i><b>2.5</b> Lesson 3</a><ul>
<li class="chapter" data-level="2.5.1" data-path="lesson-3.html"><a href="lesson-3.html#kernel-density-estimation"><i class="fa fa-check"></i><b>2.5.1</b> Kernel density estimation</a></li>
<li class="chapter" data-level="2.5.2" data-path="lesson-3.html"><a href="lesson-3.html#conditional-density"><i class="fa fa-check"></i><b>2.5.2</b> Conditional density</a></li>
<li class="chapter" data-level="2.5.3" data-path="lesson-3.html"><a href="lesson-3.html#expectation-maximization-for-the-two-latent-variables"><i class="fa fa-check"></i><b>2.5.3</b> Expectation Maximization for the two latent variables</a></li>
<li class="chapter" data-level="2.5.4" data-path="lesson-3.html"><a href="lesson-3.html#data-generation"><i class="fa fa-check"></i><b>2.5.4</b> Data Generation</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="assignment-glucose.html"><a href="assignment-glucose.html"><i class="fa fa-check"></i><b>2.6</b> assignment Glucose</a><ul>
<li class="chapter" data-level="2.6.1" data-path="assignment-glucose.html"><a href="assignment-glucose.html#defining-a-function-for-expectation-maximization-algorithm"><i class="fa fa-check"></i><b>2.6.1</b> Defining a function for Expectation-Maximization algorithm</a></li>
<li class="chapter" data-level="2.6.2" data-path="assignment-glucose.html"><a href="assignment-glucose.html#clusters-density-curves"><i class="fa fa-check"></i><b>2.6.2</b> 2 clusters density curves</a></li>
<li class="chapter" data-level="2.6.3" data-path="assignment-glucose.html"><a href="assignment-glucose.html#clusters-density-curves-1"><i class="fa fa-check"></i><b>2.6.3</b> 3 clusters density curves</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html"><i class="fa fa-check"></i><b>2.7</b> assignment Second Lead from ECG</a><ul>
<li class="chapter" data-level="2.7.1" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#defining-a-function-for-expectation-maximization-em-algorithm"><i class="fa fa-check"></i><b>2.7.1</b> Defining a function for expectation-maximization (EM) algorithm</a></li>
<li class="chapter" data-level="2.7.2" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#reading-the-data-and-ploting-the-leads-distribution"><i class="fa fa-check"></i><b>2.7.2</b> reading the data and ploting the leads distribution</a></li>
<li class="chapter" data-level="2.7.3" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#em-algorithm-for-2-latent-classes"><i class="fa fa-check"></i><b>2.7.3</b> EM algorithm for 2 latent classes</a></li>
<li class="chapter" data-level="2.7.4" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#em-algorithm-for-3-latent-classes"><i class="fa fa-check"></i><b>2.7.4</b> EM algorithm for 3 latent classes</a></li>
<li class="chapter" data-level="2.7.5" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#generating-1000-data-points-at-random-with-bootstrapped-with-guassian-distribution-and-em-with-3-clusters."><i class="fa fa-check"></i><b>2.7.5</b> Generating 1000 data points at random with bootstrapped, with guassian distribution and EM with 3 clusters.</a></li>
<li class="chapter" data-level="2.7.6" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#bonus-1"><i class="fa fa-check"></i><b>2.7.6</b> Bonus</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="lesson-4.html"><a href="lesson-4.html"><i class="fa fa-check"></i><b>2.8</b> Lesson 4</a><ul>
<li class="chapter" data-level="2.8.1" data-path="lesson-4.html"><a href="lesson-4.html#random-number-generation"><i class="fa fa-check"></i><b>2.8.1</b> Random Number Generation</a></li>
<li class="chapter" data-level="2.8.2" data-path="lesson-4.html"><a href="lesson-4.html#my-simple-solution-for-a-random-number-generator"><i class="fa fa-check"></i><b>2.8.2</b> My simple solution for a random number generator:</a></li>
<li class="chapter" data-level="2.8.3" data-path="lesson-4.html"><a href="lesson-4.html#transition-probabilities"><i class="fa fa-check"></i><b>2.8.3</b> Transition probabilities</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="lesson-5.html"><a href="lesson-5.html"><i class="fa fa-check"></i><b>2.9</b> Lesson 5</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="stats.html"><a href="stats.html"><i class="fa fa-check"></i><b>3</b> STATS</a><ul>
<li class="chapter" data-level="3.1" data-path="lesson-1-1.html"><a href="lesson-1-1.html"><i class="fa fa-check"></i><b>3.1</b> Lesson 1</a></li>
<li class="chapter" data-level="3.2" data-path="lesson-2-1.html"><a href="lesson-2-1.html"><i class="fa fa-check"></i><b>3.2</b> Lesson 2</a></li>
<li class="chapter" data-level="3.3" data-path="lesson-4-1.html"><a href="lesson-4-1.html"><i class="fa fa-check"></i><b>3.3</b> Lesson 4</a><ul>
<li class="chapter" data-level="3.3.1" data-path="lesson-4-1.html"><a href="lesson-4-1.html#generalized-linear-models-glm"><i class="fa fa-check"></i><b>3.3.1</b> Generalized Linear Models (GLM)</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lesson-5-1.html"><a href="lesson-5-1.html"><i class="fa fa-check"></i><b>3.4</b> Lesson 5</a><ul>
<li class="chapter" data-level="3.4.1" data-path="lesson-5-1.html"><a href="lesson-5-1.html#survival-analysis"><i class="fa fa-check"></i><b>3.4.1</b> Survival Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="assignment-cancer.html"><a href="assignment-cancer.html"><i class="fa fa-check"></i><b>3.5</b> Assignment <em>cancer</em></a></li>
<li class="chapter" data-level="3.6" data-path="lesson-6.html"><a href="lesson-6.html"><i class="fa fa-check"></i><b>3.6</b> Lesson 6</a><ul>
<li class="chapter" data-level="3.6.1" data-path="lesson-6.html"><a href="lesson-6.html#cox-regression"><i class="fa fa-check"></i><b>3.6.1</b> Cox Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="assignment-cancer-1.html"><a href="assignment-cancer-1.html"><i class="fa fa-check"></i><b>3.7</b> Assignment <em>cancer</em></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="learn.html"><a href="learn.html"><i class="fa fa-check"></i><b>4</b> LEARN</a><ul>
<li class="chapter" data-level="4.1" data-path="lesson-1-2.html"><a href="lesson-1-2.html"><i class="fa fa-check"></i><b>4.1</b> Lesson 1</a></li>
<li class="chapter" data-level="4.2" data-path="lesson-2-2.html"><a href="lesson-2-2.html"><i class="fa fa-check"></i><b>4.2</b> Lesson 2</a><ul>
<li class="chapter" data-level="4.2.1" data-path="lesson-2-2.html"><a href="lesson-2-2.html#test-harness"><i class="fa fa-check"></i><b>4.2.1</b> Test harness</a></li>
<li class="chapter" data-level="4.2.2" data-path="lesson-2-2.html"><a href="lesson-2-2.html#make-predictions"><i class="fa fa-check"></i><b>4.2.2</b> Make predictions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lesson-3-1.html"><a href="lesson-3-1.html"><i class="fa fa-check"></i><b>4.3</b> Lesson 3</a><ul>
<li class="chapter" data-level="4.3.1" data-path="lesson-3-1.html"><a href="lesson-3-1.html#using-rpart-and-the-breast-cancer-coimbra-data-set"><i class="fa fa-check"></i><b>4.3.1</b> Using ‘rpart’ and the Breast Cancer Coimbra data set</a></li>
<li class="chapter" data-level="4.3.2" data-path="lesson-3-1.html"><a href="lesson-3-1.html#random-forest"><i class="fa fa-check"></i><b>4.3.2</b> Random Forest</a></li>
<li class="chapter" data-level="4.3.3" data-path="lesson-3-1.html"><a href="lesson-3-1.html#improve-random-forest"><i class="fa fa-check"></i><b>4.3.3</b> Improve Random Forest</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="assignment-trees.html"><a href="assignment-trees.html"><i class="fa fa-check"></i><b>4.4</b> Assignment Trees</a></li>
<li class="chapter" data-level="4.5" data-path="assignment-trees-up-sampling.html"><a href="assignment-trees-up-sampling.html"><i class="fa fa-check"></i><b>4.5</b> Assignment Trees - Up Sampling</a></li>
<li class="chapter" data-level="4.6" data-path="lesson-4-2.html"><a href="lesson-4-2.html"><i class="fa fa-check"></i><b>4.6</b> Lesson 4</a><ul>
<li class="chapter" data-level="4.6.1" data-path="lesson-4-2.html"><a href="lesson-4-2.html#build-network-from-data-using-naive-bayes"><i class="fa fa-check"></i><b>4.6.1</b> Build network from data using naive bayes</a></li>
<li class="chapter" data-level="4.6.2" data-path="lesson-4-2.html"><a href="lesson-4-2.html#learn-the-structure-of-a-bayesian-network-using-a-hill-climbing-hc-or-a-tabu-search-tabu-greedy-search"><i class="fa fa-check"></i><b>4.6.2</b> Learn the structure of a Bayesian network using a hill-climbing (HC) or a Tabu search (TABU) greedy search</a></li>
<li class="chapter" data-level="4.6.3" data-path="lesson-4-2.html"><a href="lesson-4-2.html#fit-existing-network-using-data"><i class="fa fa-check"></i><b>4.6.3</b> Fit existing network using data</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="lesson-5-2.html"><a href="lesson-5-2.html"><i class="fa fa-check"></i><b>4.7</b> Lesson 5</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes.html"><a href="bayes.html"><i class="fa fa-check"></i><b>5</b> BAYES</a><ul>
<li class="chapter" data-level="5.1" data-path="lesson-4-3.html"><a href="lesson-4-3.html"><i class="fa fa-check"></i><b>5.1</b> Lesson 4</a><ul>
<li class="chapter" data-level="5.1.1" data-path="lesson-4-3.html"><a href="lesson-4-3.html#representing-a-betaab-distribution"><i class="fa fa-check"></i><b>5.1.1</b> Representing a Beta(a,b) distribution:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="top.html"><a href="top.html"><i class="fa fa-check"></i><b>6</b> TOP.HIDA</a><ul>
<li class="chapter" data-level="6.1" data-path="seminar1.html"><a href="seminar1.html"><i class="fa fa-check"></i><b>6.1</b> Seminar 1</a><ul>
<li class="chapter" data-level="6.1.1" data-path="seminar1.html"><a href="seminar1.html#bruno-lima"><i class="fa fa-check"></i><b>6.1.1</b> Bruno Lima</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">HEADS 2nd semester</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lesson-1-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Lesson 1</h2>
<p>2020-02-03</p>
<p><strong>exercise 1</strong>
The BMD_weight.sav database contains 190 densitometry records.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">library</span>(foreign)</a>
<a class="sourceLine" id="cb127-2" title="2"></a>
<a class="sourceLine" id="cb127-3" title="3">data1 &lt;-<span class="st"> </span><span class="kw">read.spss</span>(<span class="dt">file=</span><span class="st">&quot;2.UploadedData/BMD_weight_new.sav&quot;</span>, <span class="dt">use.missing=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Calculate the body mass index.</li>
</ol>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">data1<span class="op">$</span>IMC &lt;-<span class="st"> </span>((data1<span class="op">$</span>peso)<span class="op">/</span>((data1<span class="op">$</span>altura)<span class="op">/</span><span class="dv">100</span>)<span class="op">^</span><span class="dv">2</span>) </a></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Calculate the mean and standard deviation of total bone mineral density</li>
</ol>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">mean</span>(data1<span class="op">$</span>IMC)</a></code></pre></div>
<pre><code>## [1] 26.42143</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">sd</span>(data1<span class="op">$</span>IMC)</a></code></pre></div>
<pre><code>## [1] 4.299248</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Analyze the relationship between bone mineral density and BMI using linear regression.</li>
</ol>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="kw">plot</span>(<span class="dt">x =</span> data1<span class="op">$</span>IMC, <span class="dt">y=</span>data1<span class="op">$</span>bmdtot)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="kw">cor.test</span>(data1<span class="op">$</span>IMC, data1<span class="op">$</span>bmdtot, <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  data1$IMC and data1$bmdtot
## t = 4.4216, df = 186, p-value = 0.00001664
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.1729248 0.4324277
## sample estimates:
##       cor 
## 0.3084029</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1">regressao &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> bmdtot <span class="op">~</span><span class="st"> </span>IMC, <span class="dt">data=</span>data1)</a>
<a class="sourceLine" id="cb136-2" title="2"><span class="kw">summary</span>(regressao)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bmdtot ~ IMC, data = data1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.28807 -0.07629 -0.00038  0.08273  0.37375 
## 
## Coefficients:
##             Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept) 0.593934   0.052316  11.353 &lt; 0.0000000000000002 ***
## IMC         0.008639   0.001954   4.422            0.0000166 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1155 on 186 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared:  0.09511,    Adjusted R-squared:  0.09025 
## F-statistic: 19.55 on 1 and 186 DF,  p-value: 0.00001664</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>Compare the BMDTOT average according to the type of medication, adjusting for BMI and age.</li>
</ol>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1">regressaoM &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> bmdtot <span class="op">~</span><span class="st"> </span>Medication <span class="op">+</span><span class="st"> </span>IMC <span class="op">+</span><span class="st"> </span>idade, <span class="dt">data=</span>data1)</a></code></pre></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Check the assumptions for the model used in d).</li>
</ol>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1"><span class="kw">plot</span>(regressaoM<span class="op">$</span>fitted.values, regressaoM<span class="op">$</span>residuals)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1"><span class="kw">hist</span>(regressaoM<span class="op">$</span>residuals)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-85-2.png" width="672" /></p>
<p>or we can plot everything</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="kw">plot</span>(regressaoM)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-86-1.png" width="672" /><img src="heads2sem_files/figure-html/unnamed-chunk-86-2.png" width="672" /><img src="heads2sem_files/figure-html/unnamed-chunk-86-3.png" width="672" /><img src="heads2sem_files/figure-html/unnamed-chunk-86-4.png" width="672" /></p>
<p><strong>exercise 2</strong>
The data in the score2013.sav file refer to 1768 admissions to pediatric intensive
care units in several Portuguese hospital units.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1">data2 &lt;-<span class="st"> </span><span class="kw">read.spss</span>(<span class="dt">file=</span><span class="st">&quot;2.UploadedData/score2013.sav&quot;</span>, <span class="dt">use.missing=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>The minimum systolic tension of the first 12 hours of hospitalization and mechanical ventilation at some point in the first hour of hospitalization are potential predictors of mortality in the ICU.</li>
</ol>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="kw">summary</span>(data2)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Length</th>
<th align="left">Class</th>
<th align="left">Mode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sexo</td>
<td align="left">1768</td>
<td align="left">factor</td>
<td align="left">numeric</td>
</tr>
<tr class="even">
<td>peso</td>
<td align="left">1768</td>
<td align="left">factor</td>
<td align="left">numeric</td>
</tr>
<tr class="odd">
<td>outcome</td>
<td align="left">1768</td>
<td align="left">factor</td>
<td align="left">numeric</td>
</tr>
<tr class="even">
<td>apneia</td>
<td align="left">1768</td>
<td align="left">factor</td>
<td align="left">numeric</td>
</tr>
<tr class="odd">
<td>ventil</td>
<td align="left">1768</td>
<td align="left">factor</td>
<td align="left">numeric</td>
</tr>
<tr class="even">
<td>hmedica</td>
<td align="left">1768</td>
<td align="left">factor</td>
<td align="left">numeric</td>
</tr>
<tr class="odd">
<td>CPAP</td>
<td align="left">1768</td>
<td align="left">factor</td>
<td align="left">numeric</td>
</tr>
<tr class="even">
<td>Pupil</td>
<td align="left">1768</td>
<td align="left">factor</td>
<td align="left">numeric</td>
</tr>
<tr class="odd">
<td>TAS12</td>
<td align="left">1768</td>
<td align="left">factor</td>
<td align="left">numeric</td>
</tr>
<tr class="even">
<td>temp12</td>
<td align="left">1768</td>
<td align="left">factor</td>
<td align="left">numeric</td>
</tr>
<tr class="odd">
<td>entub</td>
<td align="left">1768</td>
<td align="left">factor</td>
<td align="left">numeric</td>
</tr>
</tbody>
</table>
<p>Study the individual association of each of them with mortality first.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1">data2<span class="op">$</span>TAS12 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">factor</span>(data2<span class="op">$</span>TAS12))</a>
<a class="sourceLine" id="cb144-2" title="2"></a>
<a class="sourceLine" id="cb144-3" title="3">logistic1 &lt;-<span class="st"> </span><span class="kw">glm</span>(outcome <span class="op">~</span><span class="st"> </span>TAS12, <span class="dt">data =</span> data2, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb144-4" title="4">logistic2 &lt;-<span class="st"> </span><span class="kw">glm</span>(outcome <span class="op">~</span><span class="st"> </span>ventil, <span class="dt">data =</span> data2, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb144-5" title="5"></a>
<a class="sourceLine" id="cb144-6" title="6"><span class="kw">summary</span>(logistic1)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = outcome ~ TAS12, family = &quot;binomial&quot;, data = data2)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.1116  -0.3953  -0.2934  -0.2225   3.0054  
## 
## Coefficients:
##              Estimate Std. Error z value            Pr(&gt;|z|)    
## (Intercept) -0.054551   0.215283  -0.253                 0.8    
## TAS12       -0.051158   0.004748 -10.776 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 948.95  on 1767  degrees of freedom
## Residual deviance: 825.01  on 1766  degrees of freedom
## AIC: 829.01
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"><span class="kw">summary</span>(logistic2)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = outcome ~ ventil, family = &quot;binomial&quot;, data = data2)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4776  -0.4776  -0.3022  -0.3022   2.4936  
## 
## Coefficients:
##             Estimate Std. Error z value             Pr(&gt;|z|)    
## (Intercept)  -3.0634     0.1617 -18.940 &lt; 0.0000000000000002 ***
## ventilSim     0.9500     0.1952   4.868           0.00000113 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 948.95  on 1767  degrees of freedom
## Residual deviance: 923.16  on 1766  degrees of freedom
## AIC: 927.16
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1"><span class="kw">exp</span>(<span class="kw">cbind</span>(<span class="dt">OR =</span> <span class="kw">coef</span>(logistic1), <span class="kw">confint</span>(logistic1)))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">OR</th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">0.9469106</td>
<td align="right">0.6185266</td>
<td align="right">1.4405861</td>
</tr>
<tr class="even">
<td>TAS12</td>
<td align="right">0.9501285</td>
<td align="right">0.9411981</td>
<td align="right">0.9589037</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1"><span class="kw">exp</span>(<span class="kw">cbind</span>(<span class="dt">OR =</span> <span class="kw">coef</span>(logistic2), <span class="kw">confint</span>(logistic2)))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">OR</th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">0.046729</td>
<td align="right">0.0334873</td>
<td align="right">0.0632424</td>
</tr>
<tr class="even">
<td>ventilSim</td>
<td align="right">2.585604</td>
<td align="right">1.7772140</td>
<td align="right">3.8273766</td>
</tr>
</tbody>
</table>
<p>Then test the interaction of these two variables and interpret the results.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1">logistic3 &lt;-<span class="st"> </span><span class="kw">glm</span>(outcome <span class="op">~</span><span class="st"> </span>ventil <span class="op">+</span><span class="st"> </span>TAS12 <span class="op">+</span><span class="st"> </span>ventil <span class="op">*</span><span class="st"> </span>TAS12, <span class="dt">data =</span> data2, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb150-2" title="2"></a>
<a class="sourceLine" id="cb150-3" title="3"><span class="kw">summary</span>(logistic3)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = outcome ~ ventil + TAS12 + ventil * TAS12, family = &quot;binomial&quot;, 
##     data = data2)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.2779  -0.3739  -0.2875  -0.2301   3.0171  
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     -1.323763   0.464494  -2.850 0.004373 ** 
## ventilSim        1.669344   0.529036   3.155 0.001603 ** 
## TAS12           -0.031758   0.008677  -3.660 0.000252 ***
## ventilSim:TAS12 -0.024409   0.010569  -2.310 0.020914 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 948.95  on 1767  degrees of freedom
## Residual deviance: 811.29  on 1764  degrees of freedom
## AIC: 819.29
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="kw">exp</span>(<span class="kw">cbind</span>(<span class="dt">OR =</span> <span class="kw">coef</span>(logistic3), <span class="kw">confint</span>(logistic3)))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">OR</th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">0.2661319</td>
<td align="right">0.1024458</td>
<td align="right">0.6380664</td>
</tr>
<tr class="even">
<td>ventilSim</td>
<td align="right">5.3086860</td>
<td align="right">1.9349881</td>
<td align="right">15.5012115</td>
</tr>
<tr class="odd">
<td>TAS12</td>
<td align="right">0.9687412</td>
<td align="right">0.9524027</td>
<td align="right">0.9854715</td>
</tr>
<tr class="even">
<td>ventilSim:TAS12</td>
<td align="right">0.9758865</td>
<td align="right">0.9557194</td>
<td align="right">0.9962234</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: lower-alpha">
<li>Using all the variables in the database, build a model for mortality and study the model’s discrimination and calibration.</li>
</ol>
<p>accuracy</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1">pred&lt;-<span class="kw">predict</span>(logistic3, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb153-2" title="2"></a>
<a class="sourceLine" id="cb153-3" title="3">pred01&lt;-<span class="kw">ifelse</span>(pred<span class="op">&lt;</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb153-4" title="4"></a>
<a class="sourceLine" id="cb153-5" title="5"></a>
<a class="sourceLine" id="cb153-6" title="6"><span class="kw">table</span>(pred01,data2<span class="op">$</span>outcome)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">pred01/</th>
<th align="right">Vivo</th>
<th align="right">Falecido</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="right">1624</td>
<td align="right">121</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">10</td>
<td align="right">13</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1">acc&lt;-(<span class="dv">1624</span><span class="op">+</span><span class="dv">13</span>)<span class="op">/</span>(<span class="dv">1624</span><span class="op">+</span><span class="dv">121</span><span class="op">+</span><span class="dv">10</span><span class="op">+</span><span class="dv">13</span>)</a>
<a class="sourceLine" id="cb154-2" title="2"></a>
<a class="sourceLine" id="cb154-3" title="3">acc</a></code></pre></div>
<pre><code>## [1] 0.925905</code></pre>
<p>AUC</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1"><span class="kw">library</span>(pROC)</a>
<a class="sourceLine" id="cb156-2" title="2">g &lt;-<span class="st"> </span><span class="kw">roc</span>(outcome <span class="op">~</span><span class="st"> </span>pred, <span class="dt">data =</span> data2)</a>
<a class="sourceLine" id="cb156-3" title="3"><span class="kw">plot</span>(g)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<p>Goodness of fit test</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1"><span class="kw">library</span>(ResourceSelection)</a>
<a class="sourceLine" id="cb157-2" title="2"></a>
<a class="sourceLine" id="cb157-3" title="3"><span class="kw">hoslem.test</span>(data2<span class="op">$</span>outcome, pred01)</a></code></pre></div>
<pre><code>## 
##  Hosmer and Lemeshow goodness of fit (GOF) test
## 
## data:  data2$outcome, pred01
## X-squared = 1768, df = 8, p-value &lt; 0.00000000000000022</code></pre>
<p><img src="images/LogoFMUP.png" alt="logotipo FMUP" style="width:100px;height:40px;" align="right"></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="stats.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lesson-2-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["heads2sem.pdf", "heads2sem.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
