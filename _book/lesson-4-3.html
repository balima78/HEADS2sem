<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.1 Lesson 4 | HEADS 2nd semester</title>
  <meta name="description" content="HEADS’s homeworks compilation." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="5.1 Lesson 4 | HEADS 2nd semester" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="HEADS’s homeworks compilation." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.1 Lesson 4 | HEADS 2nd semester" />
  
  <meta name="twitter:description" content="HEADS’s homeworks compilation." />
  

<meta name="author" content="Bruno A Lima" />


<meta name="date" content="2020-03-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayes.html"/>
<link rel="next" href="top.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">HEADS 2nd semester 2019/2020</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="compstat.html"><a href="compstat.html"><i class="fa fa-check"></i><b>2</b> COMPSTAT</a><ul>
<li class="chapter" data-level="2.1" data-path="lesson-1.html"><a href="lesson-1.html"><i class="fa fa-check"></i><b>2.1</b> Lesson 1</a></li>
<li class="chapter" data-level="2.2" data-path="lesson-2.html"><a href="lesson-2.html"><i class="fa fa-check"></i><b>2.2</b> Lesson 2</a></li>
<li class="chapter" data-level="2.3" data-path="assignment-histogram.html"><a href="assignment-histogram.html"><i class="fa fa-check"></i><b>2.3</b> assignment Histogram</a></li>
<li class="chapter" data-level="2.4" data-path="assignment-matrix.html"><a href="assignment-matrix.html"><i class="fa fa-check"></i><b>2.4</b> assignment Matrix</a><ul>
<li class="chapter" data-level="2.4.1" data-path="assignment-matrix.html"><a href="assignment-matrix.html#keep-sample-matrix"><i class="fa fa-check"></i><b>2.4.1</b> keep sample matrix</a></li>
<li class="chapter" data-level="2.4.2" data-path="assignment-matrix.html"><a href="assignment-matrix.html#keep-sample-matrix-over-a-sliding-window"><i class="fa fa-check"></i><b>2.4.2</b> keep sample matrix over a sliding window</a></li>
<li class="chapter" data-level="2.4.3" data-path="assignment-matrix.html"><a href="assignment-matrix.html#keep-sample-matrix-over-a-alpha-weighted-sliding-window"><i class="fa fa-check"></i><b>2.4.3</b> keep sample matrix over a alpha weighted sliding window</a></li>
<li class="chapter" data-level="2.4.4" data-path="assignment-matrix.html"><a href="assignment-matrix.html#keep-sample-matrix-over-a-alpha-fading-window"><i class="fa fa-check"></i><b>2.4.4</b> keep sample matrix over a alpha fading window</a></li>
<li class="chapter" data-level="2.4.5" data-path="assignment-matrix.html"><a href="assignment-matrix.html#bonus"><i class="fa fa-check"></i><b>2.4.5</b> Bonus</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="lesson-3.html"><a href="lesson-3.html"><i class="fa fa-check"></i><b>2.5</b> Lesson 3</a><ul>
<li class="chapter" data-level="2.5.1" data-path="lesson-3.html"><a href="lesson-3.html#kernel-density-estimation"><i class="fa fa-check"></i><b>2.5.1</b> Kernel density estimation</a></li>
<li class="chapter" data-level="2.5.2" data-path="lesson-3.html"><a href="lesson-3.html#conditional-density"><i class="fa fa-check"></i><b>2.5.2</b> Conditional density</a></li>
<li class="chapter" data-level="2.5.3" data-path="lesson-3.html"><a href="lesson-3.html#expectation-maximization-for-the-two-latent-variables"><i class="fa fa-check"></i><b>2.5.3</b> Expectation Maximization for the two latent variables</a></li>
<li class="chapter" data-level="2.5.4" data-path="lesson-3.html"><a href="lesson-3.html#data-generation"><i class="fa fa-check"></i><b>2.5.4</b> Data Generation</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="assignment-glucose.html"><a href="assignment-glucose.html"><i class="fa fa-check"></i><b>2.6</b> assignment Glucose</a><ul>
<li class="chapter" data-level="2.6.1" data-path="assignment-glucose.html"><a href="assignment-glucose.html#defining-a-function-for-expectation-maximization-algorithm"><i class="fa fa-check"></i><b>2.6.1</b> Defining a function for Expectation-Maximization algorithm</a></li>
<li class="chapter" data-level="2.6.2" data-path="assignment-glucose.html"><a href="assignment-glucose.html#clusters-density-curves"><i class="fa fa-check"></i><b>2.6.2</b> 2 clusters density curves</a></li>
<li class="chapter" data-level="2.6.3" data-path="assignment-glucose.html"><a href="assignment-glucose.html#clusters-density-curves-1"><i class="fa fa-check"></i><b>2.6.3</b> 3 clusters density curves</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html"><i class="fa fa-check"></i><b>2.7</b> assignment Second Lead from ECG</a><ul>
<li class="chapter" data-level="2.7.1" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#defining-a-function-for-expectation-maximization-em-algorithm"><i class="fa fa-check"></i><b>2.7.1</b> Defining a function for expectation-maximization (EM) algorithm</a></li>
<li class="chapter" data-level="2.7.2" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#reading-the-data-and-ploting-the-leads-distribution"><i class="fa fa-check"></i><b>2.7.2</b> reading the data and ploting the leads distribution</a></li>
<li class="chapter" data-level="2.7.3" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#em-algorithm-for-2-latent-classes"><i class="fa fa-check"></i><b>2.7.3</b> EM algorithm for 2 latent classes</a></li>
<li class="chapter" data-level="2.7.4" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#em-algorithm-for-3-latent-classes"><i class="fa fa-check"></i><b>2.7.4</b> EM algorithm for 3 latent classes</a></li>
<li class="chapter" data-level="2.7.5" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#generating-1000-data-points-at-random-with-bootstrapped-with-guassian-distribution-and-em-with-3-clusters."><i class="fa fa-check"></i><b>2.7.5</b> Generating 1000 data points at random with bootstrapped, with guassian distribution and EM with 3 clusters.</a></li>
<li class="chapter" data-level="2.7.6" data-path="assignment-second-lead-from-ecg.html"><a href="assignment-second-lead-from-ecg.html#bonus-1"><i class="fa fa-check"></i><b>2.7.6</b> Bonus</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="lesson-4.html"><a href="lesson-4.html"><i class="fa fa-check"></i><b>2.8</b> Lesson 4</a><ul>
<li class="chapter" data-level="2.8.1" data-path="lesson-4.html"><a href="lesson-4.html#random-number-generation"><i class="fa fa-check"></i><b>2.8.1</b> Random Number Generation</a></li>
<li class="chapter" data-level="2.8.2" data-path="lesson-4.html"><a href="lesson-4.html#my-simple-solution-for-a-random-number-generator"><i class="fa fa-check"></i><b>2.8.2</b> My simple solution for a random number generator:</a></li>
<li class="chapter" data-level="2.8.3" data-path="lesson-4.html"><a href="lesson-4.html#transition-probabilities"><i class="fa fa-check"></i><b>2.8.3</b> Transition probabilities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="stats.html"><a href="stats.html"><i class="fa fa-check"></i><b>3</b> STATS</a><ul>
<li class="chapter" data-level="3.1" data-path="lesson-1-1.html"><a href="lesson-1-1.html"><i class="fa fa-check"></i><b>3.1</b> Lesson 1</a></li>
<li class="chapter" data-level="3.2" data-path="lesson-2-1.html"><a href="lesson-2-1.html"><i class="fa fa-check"></i><b>3.2</b> Lesson 2</a></li>
<li class="chapter" data-level="3.3" data-path="lesson-4-1.html"><a href="lesson-4-1.html"><i class="fa fa-check"></i><b>3.3</b> Lesson 4</a><ul>
<li class="chapter" data-level="3.3.1" data-path="lesson-4-1.html"><a href="lesson-4-1.html#generalized-linear-models-glm"><i class="fa fa-check"></i><b>3.3.1</b> Generalized Linear Models (GLM)</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lesson-5.html"><a href="lesson-5.html"><i class="fa fa-check"></i><b>3.4</b> Lesson 5</a><ul>
<li class="chapter" data-level="3.4.1" data-path="lesson-5.html"><a href="lesson-5.html#survival-analysis"><i class="fa fa-check"></i><b>3.4.1</b> Survival Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="assignment-cancer.html"><a href="assignment-cancer.html"><i class="fa fa-check"></i><b>3.5</b> Assignment <em>cancer</em></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="learn.html"><a href="learn.html"><i class="fa fa-check"></i><b>4</b> LEARN</a><ul>
<li class="chapter" data-level="4.1" data-path="lesson-1-2.html"><a href="lesson-1-2.html"><i class="fa fa-check"></i><b>4.1</b> Lesson 1</a></li>
<li class="chapter" data-level="4.2" data-path="lesson-2-2.html"><a href="lesson-2-2.html"><i class="fa fa-check"></i><b>4.2</b> Lesson 2</a><ul>
<li class="chapter" data-level="4.2.1" data-path="lesson-2-2.html"><a href="lesson-2-2.html#test-harness"><i class="fa fa-check"></i><b>4.2.1</b> Test harness</a></li>
<li class="chapter" data-level="4.2.2" data-path="lesson-2-2.html"><a href="lesson-2-2.html#make-predictions"><i class="fa fa-check"></i><b>4.2.2</b> Make predictions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lesson-3-1.html"><a href="lesson-3-1.html"><i class="fa fa-check"></i><b>4.3</b> Lesson 3</a><ul>
<li class="chapter" data-level="4.3.1" data-path="lesson-3-1.html"><a href="lesson-3-1.html#using-rpart-and-the-breast-cancer-coimbra-data-set"><i class="fa fa-check"></i><b>4.3.1</b> Using ‘rpart’ and the Breast Cancer Coimbra data set</a></li>
<li class="chapter" data-level="4.3.2" data-path="lesson-3-1.html"><a href="lesson-3-1.html#random-forest"><i class="fa fa-check"></i><b>4.3.2</b> Random Forest</a></li>
<li class="chapter" data-level="4.3.3" data-path="lesson-3-1.html"><a href="lesson-3-1.html#improve-random-forest"><i class="fa fa-check"></i><b>4.3.3</b> Improve Random Forest</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="assignment-trees.html"><a href="assignment-trees.html"><i class="fa fa-check"></i><b>4.4</b> Assignment Trees</a></li>
<li class="chapter" data-level="4.5" data-path="assignment-trees-up-sampling.html"><a href="assignment-trees-up-sampling.html"><i class="fa fa-check"></i><b>4.5</b> Assignment Trees - Up Sampling</a></li>
<li class="chapter" data-level="4.6" data-path="lesson-4-2.html"><a href="lesson-4-2.html"><i class="fa fa-check"></i><b>4.6</b> Lesson 4</a><ul>
<li class="chapter" data-level="4.6.1" data-path="lesson-4-2.html"><a href="lesson-4-2.html#build-network-from-data-using-naive-bayes"><i class="fa fa-check"></i><b>4.6.1</b> Build network from data using naive bayes</a></li>
<li class="chapter" data-level="4.6.2" data-path="lesson-4-2.html"><a href="lesson-4-2.html#learn-the-structure-of-a-bayesian-network-using-a-hill-climbing-hc-or-a-tabu-search-tabu-greedy-search"><i class="fa fa-check"></i><b>4.6.2</b> Learn the structure of a Bayesian network using a hill-climbing (HC) or a Tabu search (TABU) greedy search</a></li>
<li class="chapter" data-level="4.6.3" data-path="lesson-4-2.html"><a href="lesson-4-2.html#fit-existing-network-using-data"><i class="fa fa-check"></i><b>4.6.3</b> Fit existing network using data</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="lesson-5-1.html"><a href="lesson-5-1.html"><i class="fa fa-check"></i><b>4.7</b> Lesson 5</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes.html"><a href="bayes.html"><i class="fa fa-check"></i><b>5</b> BAYES</a><ul>
<li class="chapter" data-level="5.1" data-path="lesson-4-3.html"><a href="lesson-4-3.html"><i class="fa fa-check"></i><b>5.1</b> Lesson 4</a><ul>
<li class="chapter" data-level="5.1.1" data-path="lesson-4-3.html"><a href="lesson-4-3.html#representing-a-betaab-distribution"><i class="fa fa-check"></i><b>5.1.1</b> Representing a Beta(a,b) distribution:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="top.html"><a href="top.html"><i class="fa fa-check"></i><b>6</b> TOP.HIDA</a><ul>
<li class="chapter" data-level="6.1" data-path="seminar1.html"><a href="seminar1.html"><i class="fa fa-check"></i><b>6.1</b> Seminar 1</a><ul>
<li class="chapter" data-level="6.1.1" data-path="seminar1.html"><a href="seminar1.html#bruno-lima"><i class="fa fa-check"></i><b>6.1.1</b> Bruno Lima</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">HEADS 2nd semester</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lesson-4-3" class="section level2">
<h2><span class="header-section-number">5.1</span> Lesson 4</h2>
<p>2020-03-03</p>
<div id="representing-a-betaab-distribution" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Representing a Beta(a,b) distribution:</h3>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" title="1"><span class="co"># define the function</span></a>
<a class="sourceLine" id="cb323-2" title="2">pl.beta &lt;-<span class="st"> </span><span class="cf">function</span>(a,b, <span class="dt">asp =</span> <span class="cf">if</span>(isLim) <span class="dv">1</span>, <span class="dt">ylim =</span> <span class="cf">if</span>(isLim) <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>)) {</a>
<a class="sourceLine" id="cb323-3" title="3">  <span class="cf">if</span>(isLim &lt;-<span class="st"> </span>a <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>b <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>a <span class="op">==</span><span class="st"> </span><span class="ot">Inf</span> <span class="op">||</span><span class="st"> </span>b <span class="op">==</span><span class="st"> </span><span class="ot">Inf</span>) {</a>
<a class="sourceLine" id="cb323-4" title="4">    eps &lt;-<span class="st"> </span><span class="fl">1e-10</span></a>
<a class="sourceLine" id="cb323-5" title="5">    x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, eps, (<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)<span class="op">/</span><span class="dv">16</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="kw">c</span>(<span class="op">-</span>eps,<span class="dv">0</span>,eps), (<span class="dv">9</span><span class="op">:</span><span class="dv">15</span>)<span class="op">/</span><span class="dv">16</span>, <span class="dv">1</span><span class="op">-</span>eps, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb323-6" title="6">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb323-7" title="7">    x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">1025</span>)</a>
<a class="sourceLine" id="cb323-8" title="8">  }</a>
<a class="sourceLine" id="cb323-9" title="9">  Mean_dbeta&lt;-<span class="kw">round</span>(a<span class="op">/</span>(a<span class="op">+</span>b), <span class="dt">digits=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb323-10" title="10">  Variance_dbeta&lt;-<span class="kw">round</span>((a<span class="op">*</span>b)<span class="op">/</span>((a<span class="op">+</span>b)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(a<span class="op">+</span>b<span class="op">+</span><span class="dv">1</span>)), <span class="dt">digits=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb323-11" title="11">  Mode_dbeta&lt;-<span class="kw">round</span>((a<span class="dv">-1</span>)<span class="op">/</span>(a<span class="op">+</span>b<span class="dv">-2</span>), <span class="dt">digits=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb323-12" title="12">  P_<span class="dv">50</span>_<span class="dv">0</span>_percent_<span class="dv">0</span>&lt;-<span class="kw">qbeta</span>(<span class="fl">0.5</span>, a, b)</a>
<a class="sourceLine" id="cb323-13" title="13">  P_<span class="dv">50</span>_<span class="dv">0</span>_percent&lt;-<span class="kw">round</span>(P_<span class="dv">50</span>_<span class="dv">0</span>_percent_<span class="dv">0</span>, <span class="dt">digits=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb323-14" title="14">  P_<span class="dv">2</span>_<span class="dv">5</span>_percent_<span class="dv">0</span>&lt;-<span class="kw">qbeta</span>(<span class="fl">0.025</span>, a, b)</a>
<a class="sourceLine" id="cb323-15" title="15">  P_<span class="dv">2</span>_<span class="dv">5</span>_percent&lt;-<span class="kw">round</span>(P_<span class="dv">2</span>_<span class="dv">5</span>_percent_<span class="dv">0</span>, <span class="dt">digits=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb323-16" title="16">  P_<span class="dv">97</span>_<span class="dv">5</span>_percent_<span class="dv">0</span>&lt;-<span class="kw">qbeta</span>(<span class="fl">0.975</span>, a, b)</a>
<a class="sourceLine" id="cb323-17" title="17">  P_<span class="dv">97</span>_<span class="dv">5</span>_percent&lt;-<span class="kw">round</span>(P_<span class="dv">97</span>_<span class="dv">5</span>_percent_<span class="dv">0</span>, <span class="dt">digits=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb323-18" title="18">  fx &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">dbeta</span>(x, a,b))</a>
<a class="sourceLine" id="cb323-19" title="19">  f &lt;-<span class="st"> </span>fx; f[fx <span class="op">==</span><span class="st"> </span><span class="ot">Inf</span>] &lt;-<span class="st"> </span><span class="fl">1e100</span></a>
<a class="sourceLine" id="cb323-20" title="20">  <span class="kw">matplot</span>(x, f, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">ylim=</span>ylim, <span class="dt">asp=</span>asp,</a>
<a class="sourceLine" id="cb323-21" title="21">          <span class="dt">main =</span> <span class="kw">paste0</span> (<span class="kw">sprintf</span>(<span class="st">&quot;Beta(a=%g, b=%g)&quot;</span>, a,b)))</a>
<a class="sourceLine" id="cb323-22" title="22">  <span class="kw">print</span>(<span class="kw">paste0</span> (<span class="st">&quot;Distribution: &quot;</span>, <span class="kw">sprintf</span>(<span class="st">&quot;Beta(a=%g, b=%g)&quot;</span>, a,b)))</a>
<a class="sourceLine" id="cb323-23" title="23">  <span class="kw">print</span>(<span class="kw">paste0</span> (<span class="st">&quot;Mean=&quot;</span>, Mean_dbeta, <span class="st">&quot;; Variance=&quot;</span>, Variance_dbeta,<span class="st">&quot;; Median=&quot;</span>, P_<span class="dv">50</span>_<span class="dv">0</span>_percent, <span class="st">&quot;; Mode=&quot;</span>, Mode_dbeta))</a>
<a class="sourceLine" id="cb323-24" title="24">  <span class="kw">print</span>(<span class="kw">paste0</span> (<span class="st">&quot;Perc(2.5%)=&quot;</span>, P_<span class="dv">2</span>_<span class="dv">5</span>_percent, <span class="st">&quot;; Perc(97.5%)=&quot;</span>, P_<span class="dv">97</span>_<span class="dv">5</span>_percent))</a>
<a class="sourceLine" id="cb323-25" title="25">}</a></code></pre></div>
<div id="exercise" class="section level4">
<h4><span class="header-section-number">5.1.1.1</span> Exercise</h4>
<p>You are performing a study to estimate the Case Fatality Rate of the new Corona Virus in a rural community in China. You observed that among the 119 people formally diagnosed with the disease, three have died and 116 have recovered. The case Fatality Rate is an estimate of the probability of dying among those affected by a disease and the proportion of deaths among affected subjects is used to estimate it.</p>
<ol style="list-style-type: lower-alpha">
<li>Use the Bayesian statistical inference approach to estimate the Case Fatality Rate for this community. Assuming an uninformative prior calculate the likelihood and the posterior distribution for the parameter of interest.</li>
</ol>
<p>Likelihood x Prior = Posterior</p>
<p><span class="math inline">\(Bin(x,n)\)</span> x <span class="math inline">\(Beta(a,b)\)</span> = <span class="math inline">\(Beta(x+a,n-x+b)\)</span></p>
<p><span class="math inline">\(Bin(3,119)\)</span> x <span class="math inline">\(Beta(1,1)\)</span> = <span class="math inline">\(Beta(4,117)\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Use the R software to draw the density of the posterior distribution and to calculate its mean, median, mode and the 95% credible interval for the parameter of interest.</li>
</ol>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" title="1"><span class="kw">library</span>(printr)</a>
<a class="sourceLine" id="cb324-2" title="2"><span class="co"># plot density</span></a>
<a class="sourceLine" id="cb324-3" title="3"><span class="kw">pl.beta</span>(<span class="dv">4</span>,<span class="dv">117</span>)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-219-1.png" width="672" /></p>
<pre><code>## [1] &quot;Distribution: Beta(a=4, b=117)&quot;
## [1] &quot;Mean=0.0331; Variance=0.0003; Median=0.0305; Mode=0.0252&quot;
## [1] &quot;Perc(2.5%)=0.0092; Perc(97.5%)=0.0713&quot;</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Based on the available evidence regarding the parameter of interest, what is the probability of the Case Fatality Rate of the new Corona Virus being higher than 5%? And being higher than 10%?</li>
</ol>
<p>Use the following R functions that allow calculating densities, probabilities and percentiles associated with Beta distributions:</p>
<p><em>Functions to work with Beta distributions</em></p>
<p><code>dbeta(x, a, b)</code> Gives you the density at x of the distribution function Beta(a,b)</p>
<p><code>pbeta(x, a, b)</code> Gives you the probability of observing a value lower than or equal to x (P[X =&lt; x]) for the distribution function Beta(a,b)</p>
<p><code>pbeta(x, a, b, lower.tail=FALSE)</code> Gives you the probability of observing a value larger than x (P[X &gt; x]) for the distribution function Beta(a,b)</p>
<p><code>qbeta(x, a, b)</code> Gives you the percentile x of the distribution function Beta(a,b)</p>
<p><code>rbeta(n, a, b)</code> Gives you n randomly chosen observations from the distribution function Beta(a,b)</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" title="1">p5.a &lt;-<span class="st"> </span><span class="kw">pbeta</span>(<span class="fl">0.05</span>, <span class="dv">4</span>, <span class="dv">117</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb326-2" title="2">p10.a &lt;-<span class="st"> </span><span class="kw">pbeta</span>(<span class="fl">0.1</span>, <span class="dv">4</span>, <span class="dv">117</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p>P[X &gt; 0.05] = 0.14441</p>
<p>P[X &gt; 0.1] = 0.00157</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Some days later, you perform an identical study in neighbouring community. In this community, you observed that among the 419 people formally diagnosed with the disease, eight have died and 411 have recovered. Using a Bayesian inference approach, estimate the Case Fatality Rate of the new Corona Virus taking into account the available data for this community and the previous knowledge regarding the parameter of interest. Calculate the new likelihood and the new posterior distribution for the parameter of interest.</li>
</ol>
<p><span class="math inline">\(Bin(x,n)\)</span> x <span class="math inline">\(Beta(a,b)\)</span> = <span class="math inline">\(Beta(x+a,n-x+b)\)</span></p>
<p><span class="math inline">\(Bin(8,419)\)</span> x <span class="math inline">\(Beta(4,117)\)</span> = <span class="math inline">\(Beta(12, 528)\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Use the R software to draw the density of the new posterior distribution and to calculate its mean, median, mode and the 95% credible interval for the parameter of interest. Use the R function previously presented.</li>
</ol>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" title="1"><span class="co"># plot density</span></a>
<a class="sourceLine" id="cb327-2" title="2"><span class="kw">pl.beta</span>(<span class="dv">12</span>,<span class="dv">528</span>)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-221-1.png" width="672" /></p>
<pre><code>## [1] &quot;Distribution: Beta(a=12, b=528)&quot;
## [1] &quot;Mean=0.0222; Variance=0; Median=0.0216; Mode=0.0204&quot;
## [1] &quot;Perc(2.5%)=0.0116; Perc(97.5%)=0.0362&quot;</code></pre>
<ol start="6" style="list-style-type: lower-alpha">
<li>Based on all the available evidence regarding the parameter of interest after performing this second study, what is the probability of the Case Fatality Rate of the new Corona Virus being higher than 5%? And being higher than 10%? Use the R functions previously presented.</li>
</ol>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" title="1">p5.b &lt;-<span class="st"> </span><span class="kw">pbeta</span>(<span class="fl">0.05</span>, <span class="dv">12</span>, <span class="dv">528</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb329-2" title="2">p10.b &lt;-<span class="st"> </span><span class="kw">pbeta</span>(<span class="fl">0.1</span>, <span class="dv">12</span>, <span class="dv">528</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb329-3" title="3"></a>
<a class="sourceLine" id="cb329-4" title="4"><span class="kw">options</span>(<span class="dt">scipen=</span><span class="dv">999</span>)</a></code></pre></div>
<p>P[X &gt; 0.05] = 0.00034</p>
<p>P[X &gt; 0.1] = 0</p>
<ol start="7" style="list-style-type: lower-alpha">
<li>Consider an alternative situation where you use all the observations of the first and second studies as if they were obtained in a single study. Assuming an uninformative prior calculate, in this case, the likelihood and the posterior distribution for the parameter of interest. Use the R software to draw the density of the posterior distribution and to calculate its mean, median, mode and the 95% credible interval for the parameter of interest. Use the R functions previously presented.</li>
</ol>
<p><span class="math inline">\(Bin(x,n)\)</span> x <span class="math inline">\(Beta(a,b)\)</span> = <span class="math inline">\(Beta(x+a,n-x+b)\)</span></p>
<p><span class="math inline">\(Bin(3+8,119+419)\)</span> x <span class="math inline">\(Beta(1,1)\)</span> = <span class="math inline">\(Beta(12, 528)\)</span></p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" title="1"><span class="co"># plot density</span></a>
<a class="sourceLine" id="cb330-2" title="2"><span class="kw">pl.beta</span>(<span class="dv">12</span>,<span class="dv">528</span>)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-223-1.png" width="672" /></p>
<pre><code>## [1] &quot;Distribution: Beta(a=12, b=528)&quot;
## [1] &quot;Mean=0.0222; Variance=0; Median=0.0216; Mode=0.0204&quot;
## [1] &quot;Perc(2.5%)=0.0116; Perc(97.5%)=0.0362&quot;</code></pre>
<p><img src="images/LogoFMUP.png" alt="logotipo FMUP" style="width:100px;height:40px;" align="right"></p>

</div>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="bayes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="top.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["heads2sem.pdf", "heads2sem.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
