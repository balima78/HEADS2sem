<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Lesson 2 | HEADS 2nd semester</title>
  <meta name="description" content="HEADS’s homeworks compilation." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Lesson 2 | HEADS 2nd semester" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="HEADS’s homeworks compilation." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Lesson 2 | HEADS 2nd semester" />
  
  <meta name="twitter:description" content="HEADS’s homeworks compilation." />
  

<meta name="author" content="Bruno A Lima" />


<meta name="date" content="2020-02-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lesson-1-1.html"/>
<link rel="next" href="learn.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">HEADS 2nd semester 2019/2020</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="compstat.html"><a href="compstat.html"><i class="fa fa-check"></i><b>2</b> COMPSTAT</a><ul>
<li class="chapter" data-level="2.1" data-path="lesson-1.html"><a href="lesson-1.html"><i class="fa fa-check"></i><b>2.1</b> Lesson 1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="stats.html"><a href="stats.html"><i class="fa fa-check"></i><b>3</b> STATS</a><ul>
<li class="chapter" data-level="3.1" data-path="lesson-1-1.html"><a href="lesson-1-1.html"><i class="fa fa-check"></i><b>3.1</b> Lesson 1</a></li>
<li class="chapter" data-level="3.2" data-path="lesson-2.html"><a href="lesson-2.html"><i class="fa fa-check"></i><b>3.2</b> Lesson 2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="learn.html"><a href="learn.html"><i class="fa fa-check"></i><b>4</b> LEARN</a><ul>
<li class="chapter" data-level="4.1" data-path="lesson-1-2.html"><a href="lesson-1-2.html"><i class="fa fa-check"></i><b>4.1</b> Lesson 1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes.html"><a href="bayes.html"><i class="fa fa-check"></i><b>5</b> BAYES</a></li>
<li class="chapter" data-level="6" data-path="top.html"><a href="top.html"><i class="fa fa-check"></i><b>6</b> TOP.HIDA</a><ul>
<li class="chapter" data-level="6.1" data-path="seminar1.html"><a href="seminar1.html"><i class="fa fa-check"></i><b>6.1</b> Seminar 1</a><ul>
<li class="chapter" data-level="6.1.1" data-path="seminar1.html"><a href="seminar1.html#bruno-lima"><i class="fa fa-check"></i><b>6.1.1</b> Bruno Lima</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">HEADS 2nd semester</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lesson-2" class="section level2">
<h2><span class="header-section-number">3.2</span> Lesson 2</h2>
<p>Length of stay is an important indicator used in health care assessment. The UCIP_PRISM.sav database contains the record of 812 pediatric admissions in 3 intensive care units (Variable P1: Coimbra, Lisboa and Porto). We want to compare the hospitalization time (Variable tempoint) of the three units. However, we must take into account that the units may receive patients with different levels of severity. The PRISM variable is an indicator of the patient’s severity at the date of admission.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">library</span>(foreign)</a>
<a class="sourceLine" id="cb85-2" title="2"></a>
<a class="sourceLine" id="cb85-3" title="3">aula2 &lt;-<span class="st"> </span><span class="kw">read.spss</span>(<span class="dt">file=</span><span class="st">&quot;2.UploadedData/UCIP_PRISM HEADS.sav&quot;</span>, <span class="dt">use.missing=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## re-encoding from UTF-8</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">summary</span>(aula2)</a></code></pre></div>
<pre><code>##          Length Class  Mode   
## P1       812    factor numeric
## PRISM    812    -none- numeric
## tempoint 812    -none- numeric</code></pre>
<ol style="list-style-type: decimal">
<li>Make a histogram of the length of stay</li>
</ol>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">hist</span>(aula2<span class="op">$</span>tempoint)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>2.Make a linear regression model with the dependent variable length of stay (tempoint), and the intensive care unit (P1) and PRISM variables as independent variables.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">regressao &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> tempoint <span class="op">~</span><span class="st"> </span>P1 <span class="op">+</span><span class="st"> </span>PRISM, <span class="dt">data=</span>aula2)</a>
<a class="sourceLine" id="cb90-2" title="2"><span class="kw">summary</span>(regressao)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = tempoint ~ P1 + PRISM, data = aula2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -14.987  -6.568  -3.944  -0.047 255.598 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  3.84611    1.36895   2.810  0.00508 **
## P1Lisboa     4.27584    1.54619   2.765  0.00581 **
## P1Porto      2.70428    1.54758   1.747  0.08094 . 
## PRISM        0.18291    0.07643   2.393  0.01693 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.04 on 808 degrees of freedom
## Multiple R-squared:  0.01558,    Adjusted R-squared:  0.01192 
## F-statistic: 4.261 on 3 and 808 DF,  p-value: 0.005353</code></pre>
<p>3.Check that the model assumptions in question b) are not satisfied.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">plot</span>(regressao<span class="op">$</span>fitted.values, regressao<span class="op">$</span>residuals)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">hist</span>(regressao<span class="op">$</span>residuals)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-40-2.png" width="672" /></p>
<p>or you can plot everything</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">plot</span>(regressao)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-41-1.png" width="672" /><img src="heads2sem_files/figure-html/unnamed-chunk-41-2.png" width="672" /><img src="heads2sem_files/figure-html/unnamed-chunk-41-3.png" width="672" /><img src="heads2sem_files/figure-html/unnamed-chunk-41-4.png" width="672" /></p>
<p>4.Transform the length of stay variable into the Neperian logarithm of length of stay (tempoint -&gt; logtempoint).</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">aula2<span class="op">$</span>logtempoint &lt;-<span class="st"> </span><span class="kw">log</span>(aula2<span class="op">$</span>tempoint)</a></code></pre></div>
<p>5.Analyze the differences in the logarithm of length of stay between the 3 units, adjusting to the severity of the patients, ie, remake the model in question b) but with the logarithm of length of stay as dependent variable.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">logregressao &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> logtempoint <span class="op">~</span><span class="st"> </span>P1 <span class="op">+</span><span class="st"> </span>PRISM, <span class="dt">data=</span>aula2)</a>
<a class="sourceLine" id="cb96-2" title="2"><span class="kw">summary</span>(logregressao)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logtempoint ~ P1 + PRISM, data = aula2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.4230 -0.9225 -0.1198  0.7848  4.2611 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.734535   0.085985   8.543  &lt; 2e-16 ***
## P1Lisboa    0.396173   0.097117   4.079 4.96e-05 ***
## P1Porto     0.319145   0.097205   3.283  0.00107 ** 
## PRISM       0.026849   0.004801   5.593 3.06e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.133 on 808 degrees of freedom
## Multiple R-squared:  0.05785,    Adjusted R-squared:  0.05435 
## F-statistic: 16.54 on 3 and 808 DF,  p-value: 1.954e-10</code></pre>
<p>Geometric mean ratio (percentage value)</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">(<span class="kw">exp</span>(logregressao<span class="op">$</span>coefficients)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<pre><code>## (Intercept)    P1Lisboa     P1Porto       PRISM 
##  108.451271   48.612650   37.595032    2.721276</code></pre>
<p>6.Check that the model assumptions in question e) are satisfied.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">plot</span>(logregressao<span class="op">$</span>fitted.values, logregressao<span class="op">$</span>residuals)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">hist</span>(logregressao<span class="op">$</span>residuals)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-45-2.png" width="672" /></p>
<p>or you can plot everything</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">plot</span>(logregressao)</a></code></pre></div>
<p><img src="heads2sem_files/figure-html/unnamed-chunk-46-1.png" width="672" /><img src="heads2sem_files/figure-html/unnamed-chunk-46-2.png" width="672" /><img src="heads2sem_files/figure-html/unnamed-chunk-46-3.png" width="672" /><img src="heads2sem_files/figure-html/unnamed-chunk-46-4.png" width="672" /></p>
<p><img src="images/LogoFMUP.png" alt="logotipo FMUP" style="width:100px;height:40px;" align="right"></p>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="lesson-1-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="learn.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["heads2sem.pdf", "heads2sem.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
